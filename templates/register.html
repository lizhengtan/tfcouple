<!DOCTYPE html>
<html>

  <head>
    <title>Register</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/css/bootstrap.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
        <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
    <!--导航-->
    <!--282结构-->
    <nav class="navbar navbar-default" role="navigation">
      <div class="row">

        <div class='col-xs-2 col-sm-2 col-md-2'>
        </div>

        <div class='col-xs-8 col-sm-8 col-md-8'>

          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">tfcouple</a>
          </div>

          <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">

            <ul class="nav navbar-nav">
              <li class="active"><a href="#">首页</a></li>
              <li><a href="/information">个人信息</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">技能点<b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="#">Python</a></li>
                  <li><a href="#">JavaScript</a></li>
                  <li><a href="#">SQL</a></li>
                  <!--<li class="divider"></li>--><!--li中划线示例-->
                  <li><a href="#">Photoshop</a></li>
                  <li><a href="#">Excel</a></li>
                </ul>
              </li>
            </ul>

  <!--导航栏中的搜索，暂时用不上
            <form class="navbar-form navbar-left" role="search">
              <div class="form-group">
                <input type="text" class="form-control" placeholder="Search">
              </div>
              <button type="submit" class="btn btn-default">Submit</button>
            </form>
  -->
  <!--右侧导航
            <ul class="nav navbar-nav navbar-right">
              <li><a href="#">Link</a></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Dropdown <b class="caret"></b></a>
                <ul class="dropdown-menu">
                  <li><a href="#">Action</a></li>
                  <li><a href="#">Another action</a></li>
                  <li><a href="#">Something else here</a></li>
                  <li class="divider"></li>
                  <li><a href="#">Separated link</a></li>
                </ul>
              </li>
            </ul>
  -->
  <!--暂定天气元素，用flask后台获取Ip地址转换后渲染末班，或者用js获取Ip,ajax加载天气信息-->
            <ul class="nav navbar-nav navbar-right">
              <li><a>{{weather[0]}}</a></li>
              <li><a>{{weather[1]}}</a></li>
              <li><a>{{weather[2]}}</a></li>
              <li><a>{{weather[3]}}</a></li>
            </ul>
          </div>
        
        </div>


        <div class='col-xs-2 col-sm-2 col-md-2'>
        </div>

      </div>
    </nav>
</br></br></br></br></br></br>
      <div class='row'>
        <div class='col-xs-4 col-sm-4 col-md-4'>
        </div>
        <div class='col-xs-4 col-sm-4 col-md-4'>
          <form role="form" style='background:#f8f8f8'>
          </br>
            <div class='row'>
              <div class='col-xs-1 col-sm-1 col-md-1 form-group'>
              </div>
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <h4 for='user' class='text-left'>登录账户</h4>
              </div>
              <div class='col-xs-5 col-sm-5 col-md-5 form-group'>
                <input type='text' class='form-control' id='user' placeholder='请输入用户名'>
              </div>
              <div class='cols-xs-3 col-sm-3 col-md-3 form-group'>
                <div id='user_success' class='hidden'>
                  <h5 class="text-success text-left">用户可注册</h5>
                </div>
                <div id='user_danger' class='hidden'>
                  <h5 class="text-danger text-left">用户已注册</h5>
                </div>
              </div>
            </div>

            <div class='row'>
              <div class='col-xs-1 col-sm-1 col-md-1 form-group'>
              </div>
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <h4 for='psw' class='text-left'>登录密码</h4>
              </div>
              <div class='col-xs-5 col-sm-5 col-md-5 form-group'>
                <input type='password' class='form-control' id='psw' placeholder='请输入密码'>
              </div>
              <div class='cols-xs-3 col-sm-3 col-md-3 form-group'>
              </div>
            </div>

            <div class='row'>
              <div class='col-xs-1 col-sm-1 col-md-1 form-group'>
              </div>              
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <h4 for='psw2' class='text-left'>重复密码</h4>
              </div>
              <div class='col-xs-5 col-sm-5 col-md-5 form-group'>
                <input type='password' class='form-control' id='psw2' placeholder='请再次输入密码'>
              </div>
              <div class='cols-xs-3 col-sm-3 col-md-3 form-group'>
                <div id='psw_success' class='hidden'>
                  <h5 class="text-success text-left">密码一致</h5>
                </div>
                <div id='psw_danger' class='hidden'>
                  <h5 class="text-danger text-left">密码不一致</h5>
                </div>
              </div>
            </div>

            <div class='row'>
              <div class='col-xs-1 col-sm-1 col-md-1 form-group'>
              </div>              
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <h4 for='email' class='text-left'>备用邮箱</h4>
              </div>
              <div class='col-xs-5 col-sm-5 col-md-5 form-group'>
                <input type='email' class='form-control' id='email' placeholder='请输入邮箱' >
              </div>
              <div class='cols-xs-3 col-sm-3 col-md-3 form-group'>
              </div>
            </div>

            <div class='row'>
              <div class='col-xs-1 col-sm-1 col-md-1 form-group'>
              </div>
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <button type="button" class="btn btn-success" id='submit'>    注册    </button>
              </div>
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <button type="button" class="btn btn-success" id='clean'>    清空    </button>
              </div>
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
                <button type="button" class="btn btn-success" id='login'>    登录    </button>
              </div>
              <div class='col-xs-3 col-sm-3 col-md-3 form-group'>
              </div>             
          </form>
        </div>
        <div class='col-xs-4 col-sm-4 col-md-4'>
        </div>        
      </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="http://cdn.bootcss.com/twitter-bootstrap/3.0.3/js/bootstrap.min.js"></script>
    <script>


$('#user').blur(function(){
  var user = document.getElementById('user').value;
  if(user != ''){
    searchLimit = new Object();
    searchLimit.user = user;
    $.ajax({
          type: "POST",
          url: "/search_user",
          contentType: "application/json;charset=utf-8",
          dataType: "json",
          data: JSON.stringify(searchLimit),
          success: function(data) {
            result = data['ok']
            if(result == false){
              document.getElementById('user_danger').setAttribute('class', 'show');
              document.getElementById('user_success').setAttribute('class', 'hidden');
            }else{
              document.getElementById('user_danger').setAttribute('class', 'hidden');
              document.getElementById('user_success').setAttribute('class', 'show');
            }
          },
          error: function() {
            alert('error');
          }
    });
  }else{
    document.getElementById('user_danger').setAttribute('class', 'hidden');
    document.getElementById('user_success').setAttribute('class', 'hidden');
  }
});

$('#psw').blur(function(){
  var psw = document.getElementById('psw').value;
  var psw2 = document.getElementById('psw2').value;

  if(psw!=''){
    if(psw==psw2){
    document.getElementById('psw_success').setAttribute('class','show');
    document.getElementById('psw_danger').setAttribute('class','hidden');
  }else{
    document.getElementById('psw_success').setAttribute('class','hidden');
    document.getElementById('psw_danger').setAttribute('class','show');
  }
}

});

$('#psw2').blur(function(){
  var psw = document.getElementById('psw').value;
  var psw2 = document.getElementById('psw2').value;

  if(psw!=''){
    if(psw==psw2){
    document.getElementById('psw_success').setAttribute('class','show');
    document.getElementById('psw_danger').setAttribute('class','hidden');
  }else{
    document.getElementById('psw_success').setAttribute('class','hidden');
    document.getElementById('psw_danger').setAttribute('class','show');
  }
}
});

$('#submit').click(function(){
  var user = document.getElementById('user').value;
  var psw = document.getElementById('psw').value;
  var psw2 = document.getElementById('psw2').value;
  var email = document.getElementById('email').value;
  if(user.length<6){
    alert('用户名不能低于6位');
  }else if(psw.length<6){
    alert('密码不能低于6位');
  }else if(psw!=psw2){
    alert('密码不一致，请更改');
  }else{
    insertLimit = new Object();
    insertLimit.user = user;
    insertLimit.psw = psw;
    insertLimit.email = email;

    $.ajax({
            type: "POST",
            url: "/insert_user",
            contentType: "application/json;charset=utf-8",
            dataType: "json",
            data: JSON.stringify(insertLimit),
            success: function(data) {
              alert('注册成功');
              window.location.href='/';
            },
            error: function() {
              alert('error');
            }
      });
  }

  

});

$('#clean').click(function(){
  $('#user').val(""); 
  $('#psw').val(""); 
  $('#psw2').val("");
  $('#email').val("");  
  document.getElementById('user_danger').setAttribute('class', 'hidden');
  document.getElementById('user_success').setAttribute('class', 'hidden');
  document.getElementById('psw_danger').setAttribute('class', 'hidden');
  document.getElementById('psw_success').setAttribute('class', 'hidden');
});

$('#login').click(function(){
window.location.href="/";
});

  </script>
</body>





</html>